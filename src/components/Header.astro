---
import ToggleTheme from "./ThemeToggle.jsx";
---

<header
  class="h-[96px] flex justify-between items-center toggle mx-auto max-lg:mx-[0px] w-full"
>
  <div class="pl-[115px] max-lg:pl-[20px] max-lg:w-[50%]">
    <a href="/" class="inline-block">
      <img
        src="/assets/headerlogo-light.svg"
        alt="Logo"
        width={100}
        height={100}
        loading="lazy"
        class="inline-block mr-2 w-[227px] h-[36px] max-lg:w-[50%] headerFooterLogo min-w-[200px] toggle-image"
      />
    </a>
  </div>
  <nav
    class="flex justify-center items-center gap-[40px] max-lg:gap-3 text-gray-400 h-full toggle mr-[100px] max-lg:mr-[25px]"
  >
    <a
      href="/#aboutus"
      class="nav-link max-lg:hidden cursor-pointer text-[18px]"
      onclick="document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto';"
      >About Us</a
    >
    <a
      href="/#techSolutionsSection"
      class="nav-link max-lg:hidden cursor-pointer text-[18px]"
      onclick="document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto';"
      >Services</a
    >
    <a
      href="/#realworldsolutions"
      class="nav-link max-lg:hidden cursor-pointer text-[18px]"
      onclick="document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto';document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto'; document.getElementById('icon').src=document.body.classList.contains('dark') ? '/assets/list-dark.svg' : '/assets/list-light.svg'"
      >Case Studies</a
    >
    <a
      href="/#tellusabout"
      class="nav-link max-lg:hidden cursor-pointer text-[18px]"
      onclick="document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto';document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto'; document.getElementById('icon').src=document.body.classList.contains('dark') ? '/assets/list-dark.svg' : '/assets/list-light.svg'"
      >Contact</a
    >
    <div
      class="flex justify-center items-center max-lg:justify-end"
      onclick="document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto';"
    >
      <a
        href="/#tellusabout"
        class="nav-link max-lg:hidden mx-[16] my-2 cursor-pointer"
      >
        <img
          src="/assets/textarrowupright-light.svg"
          alt="Arrow"
          loading="lazy"
          class="object-cover object-center inline-block mr-7 toggle-image"
          id="headerArrowUp"
        />
      </a>
    </div>
    <ToggleTheme client:load />
    <span
      id="nav-bar"
      class="hidden max-lg:flex justify-between items-center w-[50%]"
    >
      <img
        src="/assets/list-light.svg"
        alt="Logo"
        width={100}
        height={100}
        loading="lazy"
        id="icon"
        class="inline-block invert h-[24px] w-[24px] toggle-image"
      />
    </span>
  </nav>
</header>
<div
  class="fixed w-[100%] right-0 top-[80px] overflow-hidden hidden z-[10000000] px-[20px] py-[24px] bg-[#00000028]"
  id="menu"
  style="height:calc(100vh)"
>
  <div class="absolute inset-0 bg-sm z-0 h-full">
    <div class="relative flex flex-col justify-between h-[85%]">
      <div
        class="w-full overflow-hidden flex flex-col gap-5 justify-start items-between z-10 px-[24px] py-[40px]"
      >
        <a
          href="/#aboutus"
          class="font-urbanist text-[18px] font-normal leading-[150%] text-center rounded-[8px] pt-2 pb-3.5 w-full cursor-pointer"
          id="about"
          onclick="document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto';document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto'; document.getElementById('icon').src=document.body.classList.contains('dark') ? '/assets/list-dark.svg' : '/assets/list-light.svg'"
        >
          About Us
        </a>
        <a
          href="/#techSolutionsSection"
          class="font-urbanist text-[18px] font-normal leading-[150%] text-center rounded-[8px] pt-2 pb-3.5 w-full cursor-pointer"
          id="services"
          onclick="document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto';document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto'; document.getElementById('icon').src=document.body.classList.contains('dark') ? '/assets/list-dark.svg' : '/assets/list-light.svg'"
        >
          Services
        </a>
        <a
          href="/#realworldsolutions"
          class="font-urbanist text-[18px] font-normal leading-[150%] text-center rounded-[8px] pt-2 pb-3.5 w-full cursor-pointer"
          id="caseStudies"
          onclick="document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto';document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto'; document.getElementById('icon').src=document.body.classList.contains('dark') ? '/assets/list-dark.svg' : '/assets/list-light.svg'"
        >
          Case Studies
        </a>
        <a
          href="/#tellusabout"
          class="font-urbanist text-[18px] font-normal leading-[150%] text-center rounded-[8px] pt-2 pb-3.5 w-full cursor-pointer"
          id="contact"
          onclick="document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto';document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto'; document.getElementById('icon').src=document.body.classList.contains('dark') ? '/assets/list-dark.svg' : '/assets/list-light.svg'"
        >
          Contact
        </a>
      </div>
      <div
        class="w-full relative flex justify-center items-center border-t-[2px] border-[#BDBDBD]"
      >
        <a
          href="/#tellusabout"
          class="nav-link cursor-pointer pt-[15px]"
          onclick="document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto';document.getElementById('menu').style.display='none';document.body.style.overflow = 'auto'; document.getElementById('icon').src=document.body.classList.contains('dark') ? '/assets/list-dark.svg' : '/assets/list-light.svg'"
        >
          <img
            src="/assets/textarrowupright-light.svg"
            alt="Arrow"
            loading="lazy"
            class="object-cover object-center block toggle-image"
            id="headerArrowUp"
          />
        </a>
      </div>
    </div>
  </div>
</div>
<script defer>
  document.getElementById("nav-bar")?.addEventListener("click", () => {
    const icon = document.getElementById("icon");
    if (icon instanceof HTMLImageElement) {
      const isList = icon.src.includes("list");
      const isDark = icon.src.includes("dark");
      const theme = isDark ? "dark" : "light";
      const type = isList ? "close" : "list";
      icon.src = `/assets/${type}-${theme}.svg`;
    }
    const navBar = document.getElementById("menu");
    if (navBar) {
      if (navBar.style.display === "none" || navBar.style.display === "") {
        navBar.style.display = "block";
        document.body.style.overflow = "hidden";
      } else {
        navBar.style.display = "none";
        document.body.style.overflow = "auto";
      }
    }
  });

  window.addEventListener("load", () => {
    const hash = window.location.hash;

    // Only scroll if:
    // 1. There's a hash
    // 2. AND we either came from another page OR user clicked an <a href="#...">
    const cameFromAnotherPage =
      document.referrer &&
      new URL(document.referrer).pathname !== window.location.pathname;

    if (hash && cameFromAnotherPage) {
      const tryScroll = () => {
        const target = document.querySelector(hash);
        if (target) {
          target.scrollIntoView({ behavior: "smooth", block: "start" });
        } else {
          setTimeout(tryScroll, 100);
        }
      };
      tryScroll();
    }
  });

  document.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
      anchor.addEventListener("click", function (e) {
        e.preventDefault();
        const target = document.querySelector(this.getAttribute("href"));
        if (target) {
          target.scrollIntoView({ behavior: "smooth", block: "start" });
          history.pushState(null, "", this.getAttribute("href")); // Update hash
        }
      });
    });
  });
</script>
